#Create container for LongStitch (https://github.com/bcgsc/LongStitch) to run on NEU Discovery

FROM ubuntu

MAINTAINER Jason Selwyn "j.selwyn@northeastern.edu"

RUN apt-get update -y && apt-get upgrade -y
RUN apt-get install -y bsdmainutils libgomp1 make openmpi-bin ssh sudo \
                  automake g++ libboost-dev libopenmpi-dev libsparsehash-dev \
                  git


WORKDIR /opt

# Install miniconda
ENV CONDA_DIR /opt/conda
RUN wget --quiet https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda.sh && \
     /bin/bash ~/miniconda.sh -b -p /opt/conda

# Put conda in path so we can use conda activate
ENV PATH=$CONDA_DIR/bin:$PATH




# Install Abyss (https://github.com/bcgsc/abyss)
#RUN git clone https://github.com/bcgsc/abyss \
#  && cd /opt/abyss \
#  && ./autogen.sh \
#  && mkdir build && cd build \
#  && ../configure --with-mpi=/usr/lib/x86_64-linux-gnu/openmpi \
#  && make install-strip



# test abyss
#mkdir /opt/test && cd /opt/test
#wget http://www.bcgsc.ca/platform/bioinfo/software/abyss/releases/1.3.4/test-data.tar.gz
#tar xzvf test-data.tar.gz
#abyss-pe k=25 name=test B=1G \
#	in='test-data/reads1.fastq test-data/reads2.fastq'
